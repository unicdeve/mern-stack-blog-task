{"version":3,"sources":["../../src/validations/changePassword.js"],"names":["validateChangePasswordInput","data","password","newPassword","confirmPassword","errors","validator","isEmpty","isLength","min","max","equals","isValid"],"mappings":";;;;;kBAGwBA,2B;;AAHxB;;;;AACA;;;;;;AAEe,SAASA,2BAAT,CAAqCC,IAArC,EAA2C;AAAA,MAClDC,QADkD,GACPD,IADO,CAClDC,QADkD;AAAA,MACxCC,WADwC,GACPF,IADO,CACxCE,WADwC;AAAA,MAC3BC,eAD2B,GACPH,IADO,CAC3BG,eAD2B;;AAExD,MAAMC,SAAS,EAAf;;AAEAH,aAAW,CAAC,uBAAQA,QAAR,CAAD,GAAqBA,QAArB,GAAgC,EAA3C;AACAC,gBAAc,CAAC,uBAAQA,WAAR,CAAD,GAAwBA,WAAxB,GAAsC,EAApD;AACAC,oBAAkB,CAAC,uBAAQA,eAAR,CAAD,GAA4BA,eAA5B,GAA8C,EAAhE;;AAEA,MAAIE,oBAAUC,OAAV,CAAkBL,QAAlB,CAAJ,EAAiC;AAC/BG,WAAOH,QAAP,GAAkB,oCAAlB;AACD;;AAED,MAAI,CAACI,oBAAUE,QAAV,CAAmBL,WAAnB,EAAgC,EAAEM,KAAK,CAAP,EAAUC,KAAK,EAAf,EAAhC,CAAL,EACEL,OAAOF,WAAP,GAAqB,4CAArB;;AAEF,MAAIG,oBAAUC,OAAV,CAAkBH,eAAlB,CAAJ,EACEC,OAAOD,eAAP,GAAyB,oCAAzB;;AAEF,MAAI,CAACE,oBAAUK,MAAV,CAAiBR,WAAjB,EAA8BC,eAA9B,CAAL,EACEC,OAAOD,eAAP,GAAyB,2BAAzB;;AAEF,SAAO;AACLC,kBADK;AAELO,aAAS,uBAAQP,MAAR;AAFJ,GAAP;AAID","file":"changePassword.js","sourcesContent":["import validator from 'validator';\nimport isEmpty from './isEmpty';\n\nexport default function validateChangePasswordInput(data) {\n  let { password, newPassword, confirmPassword } = data;\n  const errors = {};\n\n  password = !isEmpty(password) ? password : '';\n  newPassword = !isEmpty(newPassword) ? newPassword : '';\n  confirmPassword = !isEmpty(confirmPassword) ? confirmPassword : '';\n\n  if (validator.isEmpty(password)) {\n    errors.password = 'Please enter your current password';\n  }\n\n  if (!validator.isLength(newPassword, { min: 6, max: 30 }))\n    errors.newPassword = 'New password must be at least 6 characters';\n\n  if (validator.isEmpty(confirmPassword))\n    errors.confirmPassword = 'Confirm Password field is required';\n\n  if (!validator.equals(newPassword, confirmPassword))\n    errors.confirmPassword = 'Both passwords must match';\n\n  return {\n    errors,\n    isValid: isEmpty(errors)\n  };\n}\n"]}